<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R.Y.M.E.C Events Management</title>
    <link rel="stylesheet" href="adminview.css">
</head>
<body>
    <header class="header">
        <div class="logo-container">
            <div class="logo-circle">
                <img src="Rlogo.jpg" alt="logo">
            </div>
        </div>
        <div class="header-content">
            <h1>Veerashaiva Vidyavardhaka Sangha's</h1>
            <h2>R.Y.M.E.C Events Management</h2>
        </div>
        <img src="images.jpg" alt="College Logo" class="header-logo">
    </header>

    <nav>
        <a href="home.html">Home</a>
        <a href="stdregisteredview.html">student Registered list</a>
        <a href="admlogin.html">Logout</a>
    </nav>
    <div class="btn">
        <button type="submit" class="addevent"><a href="eventadd.html">Add Event</a></button>
    </div>
    <div class="container">
        <h2 class="table-title">All Events</h2>
        <table>
            <thead>
                <tr>
                    <th>Event Name</th>
                    <th>Category</th>
                    <th>Branch</th>
                    <th>Location</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="eventTableBody">
                <!-- Dynamic Rows Will Be Inserted Here -->
            </tbody>
        </table>
    </div>

    <script>
        const API_URL = 'http://127.0.0.1:8000/events/';

        // Fetch events and display in the table
        function fetchEvents() {
            fetch(API_URL)
                .then(response => response.json())
                .then(events => {
                    const tableBody = document.getElementById('eventTableBody');
                    tableBody.innerHTML = ''; // Clear existing rows
                    events.forEach(event => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${event.event_title}</td>
                            <td>${event.category}</td>
                            <td>${event.branch}</td>
                            <td>${event.venue}</td>
                            <td>
                                <button onclick="deleteEvent(${event.event_id})">Delete</button>
                            </td>
                        `;
                        tableBody.appendChild(row);
                    });
                })
                .catch(error => console.error('Error fetching events:', error));
        }

        // Update event
        // function updateEvent(eventId) {
        //     const newTitle = prompt('Enter new event title:');
        //     if (!newTitle) return;

        //     fetch(`${API_URL}${eventId}/`, {
        //         method: 'PUT',
        //         headers: {
        //             'Content-Type': 'application/json',
        //         },
        //         body: JSON.stringify({ event_title: newTitle }),
        //     })
        //         .then(response => {
        //             if (response.ok) {
        //                 alert('Event updated successfully!');
        //                 fetchEvents();
        //             } else {
        //                 alert('Failed to update event.');
        //             }
        //         })
        //         .catch(error => console.error('Error updating event:', error));
        // }

        // Delete event
        function deleteEvent(eventId) {
            if (!confirm('Are you sure you want to delete this event?')) return;

            fetch(`${API_URL}${eventId}/`, {
                method: 'DELETE',
            })
                .then(response => {
                    if (response.ok) {
                        alert('Event deleted successfully!');
                        fetchEvents();
                    } else {
                        alert('Failed to delete event.');
                    }
                })
                .catch(error => console.error('Error deleting event:', error));
        }

        // Fetch events when the page loads
        document.addEventListener('DOMContentLoaded', fetchEvents);
    </script>
</body>
</html>
