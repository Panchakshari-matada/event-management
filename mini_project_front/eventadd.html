<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Event Management</title>
    <link rel="stylesheet" href="eventadd.css" />
  </head>
  <body>
    <header class="header">
      <div class="logo-container">
        <div class="logo-circle">
          <img src="Rlogo.jpg" alt="logo">
        </div>
      </div>
      <div class="header-content">
        <h1>Veerashaiva Vidyavardhaka Sangha's</h1>
        <h2>R.Y.M.E.C Events Management</h2>
      </div>
      <img src="images.jpg" alt="College Logo" class="header-logo" />
    </header>
    <div class="container">
      <h2>Post an Event</h2>
      <form action="adminview.html" id="eventForm" enctype="multipart/form-data">
        <div class="form-group">
          <label for="event_title">Event Title:</label>
          <input
            type="text"
            id="event_title"
            name="event_title"
            maxlength="255"
            required
          />
        </div>
        <div class="form-group">
          <label for="category">Category:</label>
          <input
            type="text"
            id="category"
            name="category"
            maxlength="100"
            required
          />
        </div>
        <div class="form-group">
          <label for="branch">Branch:</label>
          <input
            type="text"
            id="branch"
            name="branch"
            maxlength="20"
            required
          />
        </div>
        <div class="form-group">
          <label for="description">Description:</label>
          <input type="text" id="description" name="description" required />
        </div>
        <div class="form-group">
          <label for="venue">Venue:</label>
          <input type="text" id="venue" name="venue" maxlength="255" required />
        </div>
        <div class="form-group">
          <label for="timing">Timing:</label>
          <input type="datetime-local" id="timing" name="timing" required />
        </div>
        <div class="form-group">
          <label for="name_of_coordinator">Name of Event Coordinator:</label>
          <input
            type="text"
            id="name_of_coordinator"
            name="name_of_coordinator"
            maxlength="255"
            required
          />
        </div>
        <div class="form-group">
          <label for="phone_number">Phone Number:</label>
          <input
            type="text"
            id="phone_number"
            name="phone_number"
            maxlength="15"
            required
          />
        </div>
        <div class="form-group">
          <label for="upload_poster">Upload Poster:</label>
          <input
            type="file"
            id="upload_poster"
            name="upload_poster"
            accept="image/*"
          />
        </div>
        <button type="submit">Post Event</button>
      </form>
    </div>
    <script>
      document.getElementById("eventForm").addEventListener("submit", (e) => {
        e.preventDefault(); // Prevent default form submission behavior

        const formData = new FormData(e.target); // Gather form data

        fetch("http://127.0.0.1:8000/events/", {
          method: "POST",
          body: formData, // Send form data
        })
          .then((response) => {
            if (response.ok) {
              return response.json();
            } else {
              throw new Error("Error posting event");
            }
          })
          .then((data) => {
            alert("Event posted successfully!"); // Show success alert
            window.location.href = "adminview.html";
          })
        .catch((error) => alert(error.message));
      });
    </script>
  </body>
</html>
